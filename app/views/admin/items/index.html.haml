- provide :title, "#{@collection.title} | Items"
- provide :body_id, 'admin_items_index'
- provide :active_nav, 'entities'

= admin_breadcrumb({ label: 'Home', url: admin_root_path },
                   { label: 'Collections', url: admin_collections_path },
                   { label: @collection.title, url: admin_collection_path(@collection) },
                   { label: 'Items' })

.clearfix
  .btn-group.float-right{role: "group"}
    -# Import button
    %button.btn.btn-light{"data-target": "#dl-import-modal",
                          "data-toggle": "modal",
                          type: "button"}
    = (@collection.package_profile && @collection.medusa_file_group) ? '' : 'disabled=disabled'
    \&gt;
    %i.fas.fa-sync-alt
    Import
  -# Metadata
  .btn-group
    %button.btn.btn-light.dropdown-toggle{"aria-expanded": "false",
                                          "data-toggle": "dropdown",
                                          type: "button"}
      %i.fa.fa-list
      Metadata
      %span.caret
    .dropdown-menu
      = link_to 'Edit Result Set',
                admin_collection_edit_all_items_path(@collection),
                id: 'dl-edit-result-set-metadata-link',
                class: "dropdown-item #{@collection.metadata_profile ? '' : 'disabled'}"
      .dropdown-divider
      = link_to raw('Batch Changehellip;'), '',
                'data-toggle': 'modal',
                'data-target': '#dl-batch-change-modal',
                class: "dropdown-item #{@collection.metadata_profile ? '' : 'disabled'}"
      = link_to raw('Find and Replacehellip;'), '',
                'data-toggle': 'modal',
                'data-target': '#dl-find-replace-modal',
                class: "dropdown-item #{@collection.metadata_profile ? '' : 'disabled'}"
      = link_to raw('Migrate Element Valueshellip;'), '',
                'data-toggle': 'modal',
                'data-target': '#dl-migrate-modal',
                class: "dropdown-item #{@collection.metadata_profile ? '' : 'disabled'}"
      .dropdown-divider
      = link_to raw('Import TSVhellip;'), '',
                'data-toggle': 'modal',
                'data-target': '#dl-import-tsv-modal',
                class: "dropdown-item #{(@collection.package_profile and @collection.medusa_file_group) ? '' : 'disabled'}"
      = link_to raw('Export TSVhellip;'), '',
                class: 'dropdown-item',
                'data-toggle': 'modal',
                'data-target': '#dl-export-modal'
  -# Sets button
  .btn-group
    %button.btn.btn-light.dropdown-toggle{"aria-expanded": "false",
                                          "data-toggle": "dropdown",
                                          type: "button"}
      = icon_for(ItemSet)
      Sets
      %span.caret
    .dropdown-menu
      = link_to raw('Add All Results&hellip;'), '',
                class: 'dropdown-item',
                'data-toggle': 'modal',
                'data-target': '#dl-add-all-results-to-set-modal'
      = link_to raw('Add Checked Resultshellip;'), '',
                class: 'dropdown-item',
                'data-toggle': 'modal',
                'data-target': '#dl-add-checked-items-to-set-modal'
      - if @collection.item_sets.count  0
        .dropdown-divider
        - @collection.item_sets.order(:name).each do |set|
          = link_to set, admin_collection_item_set_path(@collection, set), class: 'dropdown-item'
  -# Public button
  .btn-group
    %button.btn.btn-light.dropdown-toggle{"aria-expanded": "false",
                                          "data-toggle": "dropdown",
                                          type: "button"}
      %i.fa.fa-globe
      Public
      %span.caret
    .dropdown-menu.dropdown-menu-right
      = link_to 'Publish All Results',
                admin_collection_items_publish_path(@collection),
                method: :patch,
                id: 'dl-publish-results-link',
                class: 'dropdown-item'
      = link_to 'Publish Checked Results',
                admin_collection_items_publish_path(@collection),
                method: :patch,
                id: 'dl-publish-checked-results-link',
                class: 'dropdown-item'
      .dropdown-divider
      = link_to 'Unpublish All Results',
                admin_collection_items_unpublish_path(@collection),
                method: :patch,
                id: 'dl-unpublish-results-link',
                class: 'dropdown-item'
      = link_to 'Unpublish Checked Results',
                admin_collection_items_unpublish_path(@collection),
                method: :patch,
                id: 'dl-unpublish-checked-results-link',
                class: 'dropdown-item'
      .dropdown-divider
      = link_to 'View',
                collection_items_path(@collection),
                target: '_blank',
                class: 'dropdown-item'
  -# Purge button
  .btn-group
    %button.btn.btn-danger.dropdown-toggle{"aria-expanded": "false",
                                           "data-toggle": "dropdown",
                                           type: "button"}
      %i.fa.fa-trash
      Purge
      %span.caret
    .dropdown-menu.dropdown-menu-right
      - if current_user.can?(Permissions::PURGE_ITEMS_FROM_COLLECTION)
        = link_to raw('Items From Collection'), '',
                  'data-toggle': 'modal',
                  'data-target': '#dl-purge-items-modal',
                  class: 'dropdown-item'
      = link_to 'Cached Images From Image Server',
                admin_collection_purge_cached_images_path(@collection),
                method: 'post',
                class: 'dropdown-item'

%h1
  Items
  %small= @collection.title
