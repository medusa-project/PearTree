<% provide :title, @item.title %>
<% provide :body_id, 'items_show' %>
<% provide :active_nav, 'entities' %>

<%= admin_breadcrumb(item: @item) %>

<div class="btn-group pull-right">
  <%= link_to edit_admin_collection_item_path(@item.collection, @item),
              class: 'btn btn-default' do %>
    <i class="fa fa-pencil"></i> Edit
  <% end %>
  <%= link_to @item, class: 'btn btn-default', target: '_blank' do %>
    <i class="fa fa-globe"></i> Public View
  <% end %>
</div>

<% if @item.parent %>
  <h1 class="pt-compound-title">
    <small><%= link_to @item.parent.title, @item.parent %></small>
    <br>&nbsp;&nbsp;&#8627; <%= @item.title %>
  </h1>
<% else %>
  <h1><%= @item.title %>
    <% if @item.subtitle %>
      <br><small><%= @item.subtitle %></small>
    <% end %>
  </h1>
<% end %>

<div class="row">
  <div class="col-sm-3 col-lg-2">
    <ul class="nav nav-pills nav-stacked" role="tablist">
      <li role="presentation" class="active">
        <a href="#pt-structure" aria-controls="pt-structure" role="tab" data-toggle="tab">Structure</a>
      </li>

      <li role="presentation">
        <a href="#pt-system-info" aria-controls="pt-system-info" role="tab" data-toggle="tab">System Info</a>
      </li>

      <li role="presentation">
        <a href="#pt-descriptive-metadata" aria-controls="pt-descriptive-metadata" role="tab" data-toggle="tab">Descriptive Metadata</a>
      </li>

      <li role="presentation">
        <a href="#pt-bytestreams" aria-controls="pt-bytestreams" role="tab" data-toggle="tab">
          Bytestreams <span class="badge"><%= @item.bytestreams.length %></span></a>
      </li>

      <li role="presentation">
        <a href="#pt-viewer" aria-controls="pt-viewer" role="tab" data-toggle="tab">Viewer</a>
      </li>

      <li role="presentation">
        <a href="#pt-full-text" aria-controls="pt-full-text" role="tab" data-toggle="tab">Full Text</a>
      </li>
    </ul>
  </div>

  <div class="col-sm-9 col-lg-10">
    <div class="tab-content">
      <div role="tabpanel" class="tab-pane active" id="pt-structure">
        <%= admin_structure_of_item(@item) %>
      </div>

      <div role="tabpanel" class="tab-pane" id="pt-system-info">
        <%= thumbnail_tag(@item, ItemsHelper::DEFAULT_THUMBNAIL_SIZE) %>
        <dl>
          <dt>Repository ID</dt>
          <dd><%= @item.repository_id %></dd>
          <dt>Published</dt>
          <dd><span class="label <%= @item.published ? 'label-success' : 'label-danger' %>">
            <%= @item.published ? 'Published' : 'Unpublished' %></span></dd>
          <dt>IIIF URL</dt>
          <dd><%= link_to iiif_item_url(@item),
                          iiif_item_url(@item), target: '_blank' %></dd>
          <dt>Variant</dt>
          <dd><%= @item.variant.present? ? @item.variant : 'None' %></dd>
          <dt>Representative Item</dt>
          <dd>
            <%= @item.representative_item ? link_to(@item.representative_item.title,
                                                    admin_collection_item_path(@item.representative_item.collection,
                                                                               @item.representative_item)) : 'None' %>
          </dd>
          <dt>Page Number</dt>
          <dd><%= @item.page_number ? @item.page_number : 'None' %></dd>
          <dt>Subpage Number</dt>
          <dd><%= @item.subpage_number ? @item.subpage_number : 'None' %></dd>
          <dt>Normalized Date</dt>
          <dd><%= @item.date ? @item.date : 'None' %></dd>
          <dt>Latitude</dt>
          <dd><%= @item.latitude.present? ? @item.latitude : 'None' %></dd>
          <dt>Longitude</dt>
          <dd><%= @item.longitude.present? ? @item.longitude : 'None' %></dd>
          <dt>Created</dt>
          <dd><%= local_time(@item.created_at) %></dd>
          <dt>Last Modified</dt>
          <dd><%= local_time(@item.updated_at) %></dd>
        </dl>
      </div>

      <div role="tabpanel" class="tab-pane" id="pt-descriptive-metadata">
        <%= metadata_as_list(@item) %>
        <%= metadata_as_table(@item) %>
      </div>

      <div role="tabpanel" class="tab-pane" id="pt-bytestreams">
        <% @item.bytestreams.each do |bs| %>
          <h2><%= bs.human_readable_type %></h2>
          <%= bytestream_metadata_as_table(bs, admin: true) %>
        <% end %>
      </div>

      <div role="tabpanel" class="tab-pane" id="pt-viewer">
        <%= viewer_for(@item) %>
      </div>

      <div role="tabpanel" class="tab-pane" id="pt-full-text">
        <% if @item.full_text.present? %>
          <pre><%= @item.full_text %></pre>
        <% else %>
          <p>None</p>
        <% end %>
      </div>

    </div>
  </div>
</div>
