<% provide :title, @item_set.name %>
<% provide :body_id, 'admin_item_sets_show' %>
<% provide :active_nav, 'entities' %>

<%= admin_breadcrumb(item_set: @item_set) %>

<div class="btn btn-group pull-right" role="group">
  <!-- Edit button -->
  <button type="button" class="btn btn-default pt-edit-item-set"
          data-toggle="modal" data-target="#pt-edit-item-set-modal"
          data-item-set-id="<%= @item_set.id %>">
    <span class="fa fa-pencil"></span> Edit
  </button>

  <!-- Metadata button -->
  <div class="btn-group">
    <button type="button" class="btn btn-default dropdown-toggle"
            data-toggle="dropdown" aria-expanded="false">
      <i class="fa fa-list"></i> Metadata <span class="caret"></span>
    </button>
    <ul class="dropdown-menu" role="menu">
      <li <%= @item_set.collection.metadata_profile ? '' : 'disabled="disabled"' %>>
        <%= link_to 'Edit Items',
                    admin_collection_edit_all_items_path(@item_set.collection,
                                                         item_set: @item_set.id),
                    id: 'pt-edit-result-set-metadata-link' %>
      </li>
      <li class="divider"></li>
      <li <%= (@item_set.collection.package_profile and @item_set.collection.medusa_file_group) ? '' : 'disabled="disabled"' %>>
        <%= link_to raw('Import From TSV&hellip;'), '',
                    'data-toggle': 'modal', 'data-target': '#pt-import-tsv-modal' %>
      </li>
      <li>
        <%= link_to raw('Export As TSV&hellip;'),
                    admin_collection_item_set_items_path(@item_set.collection, @item_set, format: 'tsv') %>
      </li>
    </ul>
  </div>

  <!-- Items button -->
  <div class="btn-group">
    <button type="button" class="btn btn-default dropdown-toggle"
            data-toggle="dropdown" aria-expanded="false">
      <%= icon_for(Item) %> Items <span class="caret"></span>
    </button>
    <ul class="dropdown-menu dropdown-menu-right" role="menu">
      <li>
        <%= link_to 'Add More', admin_collection_items_path(@item_set.collection) %>
      </li>
      <li class="divider"></li>
      <li>
        <%= link_to 'Remove Checked',
                    admin_collection_item_set_items_path(@item_set.collection, @item_set),
                    class: 'pt-remove-checked',
                    method: :delete %>
      </li>
      <li>
        <%= link_to 'Remove All',
                    admin_collection_item_set_all_items_path(@item_set.collection, @item_set),
                    method: :delete %>
      </li>
    </ul>
  </div>

  <!-- Delete button -->
  <%= link_to admin_collection_item_set_path(@item_set.collection, @item_set),
              class: 'btn btn-default btn-danger', method: :delete,
              data: { confirm: 'Are you sure you want to delete this set?' } do %>
    <i class="fa fa-trash"></i> Delete
  <% end %>
</div>

<h1><%= @item_set %> <small><%= @item_set.collection.title %></small></h1>

<h2>Users</h2>

<table class="table">
  <% @item_set.users.each do |user| %>
    <tr>
      <td><%= link_to user, admin_user_path(user) %></td>
    </tr>
  <% end %>
</table>

<h2>Objects <span class="badge"><%= @items.count %></span>
  <% if @items.count > 0 %>
    <%= link_to '#', class: 'btn btn-default btn-xs pt-check-all' do %>
      <i class="fa fa-check-square-o"></i> Check All
    <% end %>
  <% end %>
</h2>

<% if @items.count > 0 %>
  <div id="pt-items" class="pt-list-results">
    <%= render partial: 'admin/items/items' %>
  </div>
<% elsif @item_set.collection.items.count > 0 %>
  <p>This set is empty.</p>
<% else %>
  <p>This set is empty, and its collection is also empty.</p>
<% end %>

<%= render partial: 'edit_set_panel', locals: { collection: @item_set.collection,
                                                item_set: @item_set } %>
<%= render partial: 'admin/items/import_tsv_panel',
           locals: { collection: @item_set.collection } %>