<div class="btn btn-group float-right">
  <button type="button" class="btn btn-light dl-add-item-set"
          data-toggle="modal" data-target="#dl-add-item-set-modal">
    <span class="fa fa-plus"></span> Add Set
  </button>
</div>

<div class="clearfix">
  <% if @collection.item_sets.count > 0 %>
    <h2>Sets</h2>

    <table class="table">
      <% @collection.item_sets.order(:name).each do |set| %>
        <tr>
          <td>
            <%= link_to set, admin_collection_item_set_path(@collection, set) %>
          </td>
          <td>
            <%= icon_for(User) %> <%= set.users.count %>
          </td>
          <td>
            <%= icon_for(Item) %> <%= number_with_delimiter(set.num_objects) %>
          </td>
        </tr>
      <% end %>
    </table>
  <% end %>
</div>

<h2>Technical Info</h2>

<table class="table">
  <tr>
    <td>ID</td>
    <td><code><%= @collection.repository_id %></code></td>
  </tr>
  <tr>
    <td>External ID</td>
    <td><code><%= @collection.external_id %></code></td>
  </tr>
  <tr>
    <td>Medusa Collection Metadata</td>
    <td>
      <span class="badge <%= @collection.public_in_medusa ? 'badge-success' : 'badge-danger' %>">
      <%= @collection.public_in_medusa ? 'Public' : 'Private' %></span>
    </td>
  </tr>
  <tr>
    <td>DLS</td>
    <td>
      <span class="badge <%= @collection.published_in_dls ? 'badge-success' : 'badge-danger' %>">
        <%= @collection.published_in_dls ? 'Published' : 'Unpublished' %></span>
      <span class="badge <%= @collection.harvestable ? 'badge-success' : 'badge-danger' %>">
        <%= @collection.harvestable ? 'Harvestable' : 'Unharvestable' %></span>
    </td>
  </tr>
  <tr>
    <td>Metadata Profile</td>
    <td>
      <% if @collection.metadata_profile %>
        <%= link_to(@collection.metadata_profile.name,
                    admin_metadata_profile_path(@collection.metadata_profile)) %>
      <% else %>
        <%= link_to("Default (#{MetadataProfile.default.name})",
                    admin_metadata_profile_path(MetadataProfile.default)) %>
      <% end %>
    </td>
  </tr>
  <tr>
    <td>Descriptive Element</td>
    <td>
      <%= @collection.descriptive_element ?
              @collection.descriptive_element.label : 'None' %>
    </td>
  </tr>
  <tr>
    <td>Package Profile</td>
    <td>
      <%= @collection.package_profile ?
              @collection.package_profile.name : 'None' %>
    </td>
  </tr>
  <tr>
    <td>Medusa File Group</td>
    <td>
      <% if @file_group %>
        <code><%= @file_group.uuid %></code>
        (<%= link_to(@file_group.title,
                    @file_group.url, target: '_blank') %>)
      <% else %>
        None
      <% end %>
    </td>
  </tr>
  <tr>
    <td>Medusa CFS Directory</td>
    <td>
      <% if @collection.medusa_cfs_directory %>
        <%= link_to(@collection.medusa_cfs_directory_id,
                    @collection.medusa_cfs_directory.url,
                    target: '_blank') %>
      <% else %>
        Same as File Group
      <% end %>
    </td>
  </tr>
  <tr>
    <td>Representative Item</td>
    <td>
      <% @representative_item = @collection.representative_item %>
      <% if @representative_item %>
        <%= link_to(@representative_item.title,
                    admin_collection_item_path(@collection, @representative_item)) %>
      <% else %>
        None
      <% end %>
    </td>
  </tr>
  <tr>
    <td>Representative Image</td>
    <td>
      <% @representative_image = @collection.representative_image %>
      <% if @representative_image.present? %>
        <% file = MedusaCfsFile.with_uuid(@representative_image) %>
        <code><%= file.uuid %></code>
        (<%= link_to(File.basename(file.repository_relative_pathname),
                     file.url, target: '_blank') %>)
      <% else %>
        None
      <% end %>
    </td>
  </tr>
  <tr>
    <td>CONTENTdm Alias</td>
    <td>
      <% if @collection.contentdm_alias.present? %>
        <code><%= @collection.contentdm_alias %></code>
      <% else %>
        None
      <% end %>
    </td>
  </tr>
  <tr>
    <td>Rights Statement</td>
    <td>
      <%= @collection.rights_statement.present? ?
              @collection.rights_statement : 'None' %>
    </td>
  </tr>
  <tr>
    <td>RightsStatements.org</td>
    <td>
      <%= @collection.rightsstatements_org_statement ?
              @collection.rightsstatements_org_statement.name : 'None' %>
    </td>
  </tr>
  <tr>
    <td>Allowed Host Groups</td>
    <td>
      <% if @collection.allowed_host_groups.any? %>
        <ul>
          <% @collection.allowed_host_groups.each do |group| %>
            <li><%= link_to group.name, admin_host_group_path(group) %></li>
          <% end %>
        </ul>
      <% else %>
        Any
      <% end %>
    </td>
  </tr>
  <tr>
    <td>Denied Host Groups</td>
    <td>
      <% if @collection.denied_host_groups.any? %>
        <ul>
          <% @collection.denied_host_groups.each do |group| %>
            <li><%= link_to group.name, admin_host_group_path(group) %></li>
          <% end %>
        </ul>
      <% else %>
        None
      <% end %>
    </td>
  </tr>
</table>
